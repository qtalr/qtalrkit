<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="qtalrkit">
<title>7. Transforming and documenting data • qtalrkit</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="7. Transforming and documenting data">
<meta property="og:description" content="qtalrkit">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">qtalrkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/qtalrkit.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Materials</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/qtalr/qtalrkit/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>7. Transforming and documenting data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/qtalr/qtalrkit/blob/HEAD/vignettes/articles/recipe-7.Rmd" class="external-link"><code>vignettes/articles/recipe-7.Rmd</code></a></small>
      <div class="d-none name"><code>recipe-7.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<!--
Purpose: To introduce the concept of transforming data to prepare it for analysis. This includes text normalization and tokenization as well as the creation of new variables by splitting, merging, and recoding existing variables.

Description: Building on our understanding of tidy data, we now look at ways to transform data to bring it more in line with our research goals. This includes modifying the unit of observation and/ or adding additional attributes to the data. We will cover some of the basic operations and make reference to the fact that these operations can be performed in a variety of ways and each project will have its own unique requirements.

Approach: We will use a practical example to demonstrate the process of transforming data. We will start with a curated dataset (MASC) and transform it to reflect a specific research goal (lexical variation across modalities and genres). We will use a variety of tools and techniques to accomplish this task.

Prerequisites: This recipe assumes a basic understanding of the concepts of and methods for data acquisition and tidying data. This includes experience with the readr, stringr, dplyr, and tidyr packages. It also assumes basic familiarity with regular expressions.

Context: This is the third of three tutorials on data preparation. The first tutorial introduced the concept of data acquisition and the second tutorial introduced the concept of tidying data. This tutorial will introduce the concept of transforming data. The accompanying lab for this recipe will continue with the options for forking/ cloning a project from GitHub, working with an existing project, and creating a new project. The lab is designed to be completed in a 50 minute class period.
-->
<p>The curated dataset reflects a tidy version of the original data. This data is relatively project-neutral. A such, project-specific changes are often made to bring the data more in line with the research goals. This may include modifying the unit of observation and/ or adding additional attributes to the data. This process may generate one or more new datasets that are used for analysis.</p>
<p>In this recipe, we will explore a practical example of transforming data. This will include operations such as:</p>
<ul>
<li>Text normalization and tokenization</li>
<li>Creating new variables by splitting, merging, and recoding existing variables</li>
<li>Augmenting data with additional variables from other sources or resources</li>
</ul>
<p>Along the way, we will employ a variety of tools and techniques to accomplish these tasks. Let's load the packages we will need for this recipe.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/juliasilge/tidytext" class="external-link">tidytext</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/qtalr/qtalrkit" class="external-link">qtalrkit</a></span><span class="op">)</span></span></code></pre></div>
<p>In Lab 7, we will apply what we have learned in this recipe to a new dataset.</p>
</div>
<div class="section level2">
<h2 id="concepts-and-strategies">Concepts and strategies<a class="anchor" aria-label="anchor" href="#concepts-and-strategies"></a>
</h2>
<div class="section level3">
<h3 id="orientation">Orientation<a class="anchor" aria-label="anchor" href="#orientation"></a>
</h3>
<!-- about curated data and goal of transformation -->
<p>Curated datasets are often project-neutral. That is, they are not necessarily designed to answer a specific research question. Rather, they are designed to be flexible enough to be used in a variety of projects. This is a good thing, but it also means that we will likely need to transform the data to bring it more in line with our research goals. This can include normalizing text, modifying the unit of observation and/ or adding additional attributes to the data.</p>
<!-- about the MASC dataset -->
<p>In this recipe, we will explore a practical example of transforming data. We will start with a curated dataset and transform it to reflect a specific research goal. The dataset we will use is the MASC dataset <span class="citation">(<a href="#ref-Ide2008">Ide et al. 2008</a>)</span>. This dataset contains a collection of words from a variety of genres and modalities of American English.</p>
<div class="callout">
<p><strong><svg aria-hidden="true" role="img" viewbox="0 0 384 512" style="height:1em;width:0.75em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M64 64V241.6c5.2-1 10.5-1.6 16-1.6H96V208 64c0-8.8-7.2-16-16-16s-16 7.2-16 16zM80 288c-17.7 0-32 14.3-32 32c0 0 0 0 0 0v24c0 66.3 53.7 120 120 120h48c52.5 0 97.1-33.7 113.4-80.7c-3.1 .5-6.2 .7-9.4 .7c-20 0-37.9-9.2-49.7-23.6c-9 4.9-19.4 7.6-30.3 7.6c-15.1 0-29-5.3-40-14c-11 8.8-24.9 14-40 14H120c-13.3 0-24-10.7-24-24s10.7-24 24-24h40c8.8 0 16-7.2 16-16s-7.2-16-16-16H120 80zM0 320s0 0 0 0c0-18 6-34.6 16-48V64C16 28.7 44.7 0 80 0s64 28.7 64 64v82c5.1-1.3 10.5-2 16-2c25.3 0 47.2 14.7 57.6 36c7-2.6 14.5-4 22.4-4c20 0 37.9 9.2 49.7 23.6c9-4.9 19.4-7.6 30.3-7.6c35.3 0 64 28.7 64 64v64 24c0 92.8-75.2 168-168 168H168C75.2 512 0 436.8 0 344V320zm336-64c0-8.8-7.2-16-16-16s-16 7.2-16 16v48 16c0 8.8 7.2 16 16 16s16-7.2 16-16V256zM160 240c5.5 0 10.9 .7 16 2v-2V208c0-8.8-7.2-16-16-16s-16 7.2-16 16v32h16zm64 24v40c0 8.8 7.2 16 16 16s16-7.2 16-16V256 240c0-8.8-7.2-16-16-16s-16 7.2-16 16v24z"></path></svg> Tip</strong> Acquire and tidy the data</p>
<p>The MASC dataset is a curated version of the original data. This data is relatively project-neutral.</p>
<p>If you would like to acquire the original data and curate it for use in this recipe, you can do so by running the following code:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Acquire the original data</span></span>
<span><span class="fu">qtalrkit</span><span class="fu">::</span><span class="fu"><a href="../reference/get_compressed_data.html">get_compressed_data</a></span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="st">".."</span>,</span>
<span>  target_dir <span class="op">=</span> <span class="st">"data/original/masc/"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Curate the data</span></span>
<span></span>
<span><span class="co"># ... write a function and add it to the package</span></span></code></pre></div>
</div>
<p>As a starting point, I will assume that the curated dataset is available in the <code>data/derived/masc/</code> directory, as seen below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">data/</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">├──</span> analysis/</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="ex">├──</span> derived/</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="ex">│</span>   ├── masc_curated_dd.csv</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="ex">│</span>   ├── masc/</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="ex">│</span>   │   ├── masc_curated.csv</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="ex">├──</span> original/</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="ex">│</span>   ├── masc_do.csv</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="ex">│</span>   ├── masc/</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="ex">│</span>   │   ├── ...</span></code></pre></div>
<p>The first step is to inspect the data dictionary file. This file contains information about the variables in the dataset. It is also a good idea to review the data origin file, which contains information about the original data source.</p>
<p>Looking at the data dictionary, in Table <a href="#tab:masc-data-dictionary">1</a>.</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:masc-data-dictionary">Table 1: </span>Data dictionary for the MASC dataset
</caption>
<thead><tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
description
</th>
<th style="text-align:left;">
variable_type
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
file
</td>
<td style="text-align:left;">
File
</td>
<td style="text-align:left;">
ID number of the source file
</td>
<td style="text-align:left;">
character
</td>
</tr>
<tr>
<td style="text-align:left;">
ref
</td>
<td style="text-align:left;">
Reference
</td>
<td style="text-align:left;">
Reference number within the source file
</td>
<td style="text-align:left;">
integer
</td>
</tr>
<tr>
<td style="text-align:left;">
base
</td>
<td style="text-align:left;">
Base
</td>
<td style="text-align:left;">
Base form of the word (lemma)
</td>
<td style="text-align:left;">
character
</td>
</tr>
<tr>
<td style="text-align:left;">
msd
</td>
<td style="text-align:left;">
MSD
</td>
<td style="text-align:left;">
Part-of-speech tag (PENN tagset)
</td>
<td style="text-align:left;">
character
</td>
</tr>
<tr>
<td style="text-align:left;">
string
</td>
<td style="text-align:left;">
String
</td>
<td style="text-align:left;">
Text content of the word
</td>
<td style="text-align:left;">
character
</td>
</tr>
<tr>
<td style="text-align:left;">
title
</td>
<td style="text-align:left;">
Title
</td>
<td style="text-align:left;">
Title of the source file
</td>
<td style="text-align:left;">
character
</td>
</tr>
<tr>
<td style="text-align:left;">
source
</td>
<td style="text-align:left;">
Source
</td>
<td style="text-align:left;">
Name of the source
</td>
<td style="text-align:left;">
character
</td>
</tr>
<tr>
<td style="text-align:left;">
date
</td>
<td style="text-align:left;">
Date
</td>
<td style="text-align:left;">
Date of the source file (if available)
</td>
<td style="text-align:left;">
character
</td>
</tr>
<tr>
<td style="text-align:left;">
class
</td>
<td style="text-align:left;">
Class
</td>
<td style="text-align:left;">
Classification of the source. Modality and genre
</td>
<td style="text-align:left;">
character
</td>
</tr>
<tr>
<td style="text-align:left;">
domain
</td>
<td style="text-align:left;">
Domain
</td>
<td style="text-align:left;">
Domain or topic of the source
</td>
<td style="text-align:left;">
character
</td>
</tr>
</tbody>
</table>
<p>Let's read in the data and take a glimpse at it.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read the data</span></span>
<span><span class="va">masc_curated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"data/derived/masc/masc_curated.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Preview</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">masc_curated</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 591,097</span></span>
<span><span class="co">## Columns: 10</span></span>
<span><span class="co">## $ file   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "110CYL067", "110CYL067", "110CYL067", "110CYL067", "110CYL067"…</span></span>
<span><span class="co">## $ ref    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1…</span></span>
<span><span class="co">## $ base   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "december", "1998", "your", "contribution", "to", "goodwill", "…</span></span>
<span><span class="co">## $ msd    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "NNP", "CD", "PRP$", "NN", "TO", "NNP", "MD", "VB", "JJR", "IN"…</span></span>
<span><span class="co">## $ string <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "December", "1998", "Your", "contribution", "to", "Goodwill", "…</span></span>
<span><span class="co">## $ title  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "110CYL067", "110CYL067", "110CYL067", "110CYL067", "110CYL067"…</span></span>
<span><span class="co">## $ source <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "ICIC Corpus of Philanthropic Fundraising Discourse", "ICIC Cor…</span></span>
<span><span class="co">## $ date   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span><span class="co">## $ class  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "WR LT", "WR LT", "WR LT", "WR LT", "WR LT", "WR LT", "WR LT", …</span></span>
<span><span class="co">## $ domain <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "philanthropic fundraising discourse", "philanthropic fundraisi…</span></span></code></pre>
<p>We may also want to do a summary overview of the dataset with the <code>skimr</code> package. This will give us a sense of the data types and the number of missing values.</p>
<pre class="plain"><code>── Data Summary ───────────────────────
                           Values
Name                       masc_curated
Number of rows             591097
Number of columns          10
_______________________
Column type frequency:
  character                9
  numeric                  1
________________________
Group variables            None

── Variable type: character ───────────
  skim_variable n_missing complete_rate min max empty n_unique whitespace
1 file                  0         1       3  40     0      392          0
2 base                  4         1.00    1  99     0    28010          0
3 msd                   0         1       1   8     0       60          0
4 string               25         1.00    1  99     0    39474          0
5 title                 0         1       3 203     0      373          0
6 source             5732         0.990   3 139     0      348          0
7 date              94002         0.841   4  17     0       62          0
8 class                 0         1       5   5     0       18          0
9 domain            18165         0.969   4  35     0       21          0

── Variable type: numeric ─────────────
  skim_variable n_missing complete_rate  mean    sd p0 p25  p50  p75  p100 hist
1 ref                   0             1 3854. 4633.  0 549 2033 5455 24519 ▇▂▁▁▁</code></pre>
<p>In summary, the dataset contains 591,097 observations and 10 variables. The unit of observation is the word. The variable names are somewhat opaque, but the data dictionary provides some context that will help us understand the data.</p>
<p>Now we want to consider how we plan to use this data in our analysis. Let's assume that we want to use this data to explore lexical variation in the MASC dataset across modalities and genres. We will want to transform the data to reflect this goal.</p>
<p>In Table <a href="#tab:masc-transformed-idealized">2</a>, we see an idealized version of the dataset we would like to have.</p>
<table class="table">
<caption>
<span id="tab:masc-transformed-idealized">Table 2: </span> Idealized version of the MASC dataset</caption>
<thead><tr class="header">
<th>doc_id</th>
<th>modality</th>
<th>genre</th>
<th>term_num</th>
<th>term</th>
<th>lemma</th>
<th>pos</th>
</tr></thead>
<tbody><tr class="odd">
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr></tbody>
</table>
<p>Of note, in this recipe we will derive a single transformed dataset. In other projects, you may want to generate various datasets with different units of observations. It all depends on your research question and the research aim that you are adopting.</p>
</div>
<div class="section level3">
<h3 id="transforming-data">Transforming data<a class="anchor" aria-label="anchor" href="#transforming-data"></a>
</h3>
<p>To get from the curated dataset to the idealized dataset, we will need to perform a number of transformations. Some of these transformations will be relatively straightforward, while others will require more work. Let's start with the easy ones.</p>
<ol style="list-style-type: decimal">
<li>Let's drop the variables that we will not use and at the same time rename the variables to make them more intuitive.</li>
</ol>
<p>We will use the <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code> function to drop or rename variables.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Drop and rename variables</span></span>
<span><span class="va">masc_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">masc_curated</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    doc_id <span class="op">=</span> <span class="va">file</span>,</span>
<span>    term_num <span class="op">=</span> <span class="va">ref</span>,</span>
<span>    term <span class="op">=</span> <span class="va">string</span>,</span>
<span>    lemma <span class="op">=</span> <span class="va">base</span>,</span>
<span>    pos <span class="op">=</span> <span class="va">msd</span>,</span>
<span>    mod_gen <span class="op">=</span> <span class="va">class</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">masc_df</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 591,097 × 6</span></span></span>
<span><span class="co">##    doc_id    term_num term         lemma        pos   mod_gen</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 110CYL067        0 December     december     NNP   WR LT  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 110CYL067        1 1998         1998         CD    WR LT  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 110CYL067        2 Your         your         PRP$  WR LT  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 110CYL067        3 contribution contribution NN    WR LT  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 110CYL067        4 to           to           TO    WR LT  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 110CYL067        5 Goodwill     goodwill     NNP   WR LT  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 110CYL067        6 will         will         MD    WR LT  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 110CYL067        7 mean         mean         VB    WR LT  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 110CYL067        8 more         more         JJR   WR LT  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 110CYL067        9 than         than         IN    WR LT  </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 591,087 more rows</span></span></span></code></pre>
<p>That's a good start on the structure.</p>
<ol style="list-style-type: decimal">
<li>Next, we will split the <code>mod_gen</code> variable into two variables: <code>modality</code> and <code>genre</code>.</li>
</ol>
<p>We have a variable <code>mod_gen</code> that contains two pieces of information: modality and genre (e.g., <code>WR LT</code>). The information appears to separated by a space. We can make sure this is the case by tabulating the values. The <code><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count()</a></code> function will count the number of occurrences of each value in a variable, and as a side effect it will summarize the values of the variable so we can see if there are any unexpected values.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tabulate mod_gen</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">mod_gen</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">n</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 18 × 2</span></span></span>
<span><span class="co">##    mod_gen     n</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> SP TR   <span style="text-decoration: underline;">71</span>630</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> WR EM   <span style="text-decoration: underline;">62</span>036</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> WR FC   <span style="text-decoration: underline;">38</span>608</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> WR ES   <span style="text-decoration: underline;">34</span>938</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> WR FT   <span style="text-decoration: underline;">34</span>373</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> WR BL   <span style="text-decoration: underline;">33</span>278</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> WR JO   <span style="text-decoration: underline;">33</span>042</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> WR JK   <span style="text-decoration: underline;">32</span>420</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> WR NP   <span style="text-decoration: underline;">31</span>225</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> SP MS   <span style="text-decoration: underline;">29</span>879</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> WR NF   <span style="text-decoration: underline;">29</span>531</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> WR TW   <span style="text-decoration: underline;">28</span>128</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> WR GV   <span style="text-decoration: underline;">27</span>848</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span> WR TG   <span style="text-decoration: underline;">27</span>624</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span> WR LT   <span style="text-decoration: underline;">26</span>468</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span> SP FF   <span style="text-decoration: underline;">23</span>871</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span> WR TC   <span style="text-decoration: underline;">19</span>419</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span> SP TP    <span style="text-decoration: underline;">6</span>779</span></span></code></pre>
<p>Looks good, our values are separated by a space. We can use the <code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html" class="external-link">separate_wider_delim()</a></code> function from the <code>tidyr</code> package to split the variable into two variables. We will use the <code>delim</code> argument to specify the delimiter and the <code>names</code> argument to specify the names of the new variables.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Split mod_gen into modality and genre</span></span>
<span><span class="va">masc_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html" class="external-link">separate_wider_delim</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="va">mod_gen</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">" "</span>,</span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"modality"</span>, <span class="st">"genre"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">masc_df</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 591,097 × 7</span></span></span>
<span><span class="co">##    doc_id    term_num term         lemma        pos   modality genre</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 110CYL067        0 December     december     NNP   WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 110CYL067        1 1998         1998         CD    WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 110CYL067        2 Your         your         PRP$  WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 110CYL067        3 contribution contribution NN    WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 110CYL067        4 to           to           TO    WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 110CYL067        5 Goodwill     goodwill     NNP   WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 110CYL067        6 will         will         MD    WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 110CYL067        7 mean         mean         VB    WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 110CYL067        8 more         more         JJR   WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 110CYL067        9 than         than         IN    WR       LT   </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 591,087 more rows</span></span></span></code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Create a document id variable.</li>
</ol>
<p>Now that we have the variables we want, we can turn our attention to the values of the variables. Let's start with the <code>doc_id</code> variable. This may a good variable to use as the document id. If we take a look at the values, however, we can see that the values are not very informative.</p>
<p>Let's use the <code><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct()</a></code> function to only show the unique values of the variable. We will also chain a <code><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample()</a></code> function to randomly select a sample of the values. This will give us a sense of the values in the variable.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Preview doc_id</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">doc_id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 1</span></span></span>
<span><span class="co">##    doc_id             </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> JurassicParkIV-INT </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 111367             </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> NYTnewswire6       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> sw2014-ms98-a-trans</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 52713              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> new_clients        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> cable_spool_fort   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> jokes10            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> wsj_2465           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> wsj_0158</span></span></code></pre>
<p>You can run this code various times to get a different sample of values.</p>
<p>Since the <code>doc_id</code> variable is not informative, let's replace the variable's values with numeric values. In the end, we want a digit for each unique document and we want the words in each document to be grouped together.</p>
<p>To do this we will need to group the data by <code>doc_id</code> and then generate a new number for each group. We can achieve this by passing the data grouped by <code>doc_id</code> (<code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code>) to the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> function and then using the <code><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">cur_group_id()</a></code> function to generate a number for each group.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recode doc_id</span></span>
<span><span class="va">masc_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">doc_id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>doc_id <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">cur_group_id</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">masc_df</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 591,097 × 7</span></span></span>
<span><span class="co">##    doc_id term_num term         lemma        pos   modality genre</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>      1        0 December     december     NNP   WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>      1        1 1998         1998         CD    WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>      1        2 Your         your         PRP$  WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>      1        3 contribution contribution NN    WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>      1        4 to           to           TO    WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>      1        5 Goodwill     goodwill     NNP   WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>      1        6 will         will         MD    WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>      1        7 mean         mean         VB    WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>      1        8 more         more         JJR   WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>      1        9 than         than         IN    WR       LT   </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 591,087 more rows</span></span></span></code></pre>
<p>To check, we can again apply the <code><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count()</a></code> function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">doc_id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">n</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 392 × 2</span></span></span>
<span><span class="co">##     doc_id     n</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">  1</span>    158 <span style="text-decoration: underline;">24</span>520</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">  2</span>    300 <span style="text-decoration: underline;">22</span>261</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">  3</span>    112 <span style="text-decoration: underline;">18</span>459</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">  4</span>    113 <span style="text-decoration: underline;">17</span>986</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">  5</span>    215 <span style="text-decoration: underline;">17</span>302</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">  6</span>    312 <span style="text-decoration: underline;">14</span>752</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">  7</span>    311 <span style="text-decoration: underline;">13</span>376</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">  8</span>    200 <span style="text-decoration: underline;">13</span>138</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">  9</span>    217 <span style="text-decoration: underline;">11</span>753</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 10</span>    186 <span style="text-decoration: underline;">10</span>665</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 11</span>    140 <span style="text-decoration: underline;">10</span>064</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 12</span>    304  <span style="text-decoration: underline;">9</span>417</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 13</span>    154  <span style="text-decoration: underline;">9</span>277</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 14</span>     98  <span style="text-decoration: underline;">8</span>959</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 15</span>    152  <span style="text-decoration: underline;">8</span>862</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 16</span>    238  <span style="text-decoration: underline;">7</span>617</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 17</span>    240  <span style="text-decoration: underline;">7</span>580</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 18</span>    155  <span style="text-decoration: underline;">7</span>361</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 19</span>     79  <span style="text-decoration: underline;">7</span>217</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 20</span>     80  <span style="text-decoration: underline;">7</span>032</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 21</span>    230  <span style="text-decoration: underline;">6</span>931</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 22</span>    233  <span style="text-decoration: underline;">6</span>887</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 23</span>     77  <span style="text-decoration: underline;">6</span>850</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 24</span>     76  <span style="text-decoration: underline;">6</span>839</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 25</span>    156  <span style="text-decoration: underline;">6</span>664</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 26</span>     78  <span style="text-decoration: underline;">6</span>435</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 27</span>    162  <span style="text-decoration: underline;">6</span>251</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 28</span>    203  <span style="text-decoration: underline;">5</span>665</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 29</span>    137  <span style="text-decoration: underline;">5</span>654</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 30</span>    163  <span style="text-decoration: underline;">5</span>330</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 31</span>    151  <span style="text-decoration: underline;">5</span>155</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 32</span>    231  <span style="text-decoration: underline;">5</span>059</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 33</span>    211  <span style="text-decoration: underline;">4</span>656</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 34</span>    243  <span style="text-decoration: underline;">4</span>291</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 35</span>     83  <span style="text-decoration: underline;">4</span>269</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 36</span>    216  <span style="text-decoration: underline;">4</span>263</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 37</span>     92  <span style="text-decoration: underline;">4</span>148</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 38</span>     81  <span style="text-decoration: underline;">3</span>874</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 39</span>    242  <span style="text-decoration: underline;">3</span>785</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 40</span>    219  <span style="text-decoration: underline;">3</span>752</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 41</span>    235  <span style="text-decoration: underline;">3</span>745</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 42</span>    201  <span style="text-decoration: underline;">3</span>713</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 43</span>    236  <span style="text-decoration: underline;">3</span>514</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 44</span>    303  <span style="text-decoration: underline;">3</span>481</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 45</span>    183  <span style="text-decoration: underline;">3</span>353</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 46</span>    153  <span style="text-decoration: underline;">3</span>340</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 47</span>    251  <span style="text-decoration: underline;">3</span>295</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 48</span>    171  <span style="text-decoration: underline;">3</span>198</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 49</span>    172  <span style="text-decoration: underline;">3</span>151</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 50</span>    252  <span style="text-decoration: underline;">3</span>072</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 51</span>    170  <span style="text-decoration: underline;">3</span>054</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 52</span>    169  <span style="text-decoration: underline;">3</span>038</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 53</span>    253  <span style="text-decoration: underline;">2</span>848</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 54</span>    259  <span style="text-decoration: underline;">2</span>841</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 55</span>     84  <span style="text-decoration: underline;">2</span>768</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 56</span>    166  <span style="text-decoration: underline;">2</span>730</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 57</span>    167  <span style="text-decoration: underline;">2</span>691</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 58</span>    199  <span style="text-decoration: underline;">2</span>562</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 59</span>     85  <span style="text-decoration: underline;">2</span>557</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 60</span>     82  <span style="text-decoration: underline;">2</span>470</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 61</span>    283  <span style="text-decoration: underline;">2</span>387</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 62</span>    184  <span style="text-decoration: underline;">2</span>349</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 63</span>    250  <span style="text-decoration: underline;">2</span>290</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 64</span>    198  <span style="text-decoration: underline;">2</span>246</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 65</span>    310  <span style="text-decoration: underline;">2</span>242</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 66</span>    254  <span style="text-decoration: underline;">2</span>151</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 67</span>    205  <span style="text-decoration: underline;">2</span>147</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 68</span>    181  <span style="text-decoration: underline;">2</span>099</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 69</span>    187  <span style="text-decoration: underline;">1</span>978</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 70</span>    229  <span style="text-decoration: underline;">1</span>938</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 71</span>    195  <span style="text-decoration: underline;">1</span>804</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 72</span>    260  <span style="text-decoration: underline;">1</span>734</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 73</span>     75  <span style="text-decoration: underline;">1</span>697</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 74</span>    191  <span style="text-decoration: underline;">1</span>696</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 75</span>    245  <span style="text-decoration: underline;">1</span>694</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 76</span>    255  <span style="text-decoration: underline;">1</span>682</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 77</span>    257  <span style="text-decoration: underline;">1</span>613</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 78</span>    248  <span style="text-decoration: underline;">1</span>594</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 79</span>    244  <span style="text-decoration: underline;">1</span>539</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 80</span>    220  <span style="text-decoration: underline;">1</span>468</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 81</span>    213  <span style="text-decoration: underline;">1</span>451</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 82</span>    308  <span style="text-decoration: underline;">1</span>443</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 83</span>    234  <span style="text-decoration: underline;">1</span>441</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 84</span>    274  <span style="text-decoration: underline;">1</span>433</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 85</span>    247  <span style="text-decoration: underline;">1</span>426</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 86</span>    196  <span style="text-decoration: underline;">1</span>414</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 87</span>    179  <span style="text-decoration: underline;">1</span>371</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 88</span>    256  <span style="text-decoration: underline;">1</span>364</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 89</span>    209  <span style="text-decoration: underline;">1</span>354</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 90</span>    176  <span style="text-decoration: underline;">1</span>336</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 91</span>    307  <span style="text-decoration: underline;">1</span>326</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 92</span>    258  <span style="text-decoration: underline;">1</span>275</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 93</span>    249  <span style="text-decoration: underline;">1</span>271</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 94</span>    223  <span style="text-decoration: underline;">1</span>269</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 95</span>    225  <span style="text-decoration: underline;">1</span>240</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 96</span>    241  <span style="text-decoration: underline;">1</span>203</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 97</span>    226  <span style="text-decoration: underline;">1</span>171</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 98</span>    227  <span style="text-decoration: underline;">1</span>144</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 99</span>    228  <span style="text-decoration: underline;">1</span>131</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">100</span>    178  <span style="text-decoration: underline;">1</span>103</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">101</span>    150  <span style="text-decoration: underline;">1</span>102</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">102</span>    214  <span style="text-decoration: underline;">1</span>102</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">103</span>    266  <span style="text-decoration: underline;">1</span>092</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">104</span>    192  <span style="text-decoration: underline;">1</span>063</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">105</span>    232  <span style="text-decoration: underline;">1</span>030</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">106</span>    149  <span style="text-decoration: underline;">1</span>023</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">107</span>    246  <span style="text-decoration: underline;">1</span>015</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">108</span>    363  <span style="text-decoration: underline;">1</span>013</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">109</span>    141  <span style="text-decoration: underline;">1</span>004</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">110</span>    197   989</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">111</span>    177   982</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">112</span>    309   974</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">113</span>    164   941</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">114</span>    190   936</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">115</span>    353   932</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">116</span>    271   931</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">117</span>    286   925</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">118</span>    189   923</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">119</span>    193   904</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">120</span>    143   901</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">121</span>    139   898</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">122</span>    175   888</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">123</span>    298   885</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">124</span>    332   879</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">125</span>    391   869</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">126</span>    147   858</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">127</span>    297   851</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">128</span>     26   842</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">129</span>     86   842</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">130</span>    261   831</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">131</span>    212   815</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">132</span>     54   810</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">133</span>     12   809</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">134</span>    173   801</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">135</span>    146   797</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">136</span>     21   796</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">137</span>    221   794</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">138</span>    224   794</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">139</span>    306   794</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">140</span>     42   790</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">141</span>    145   783</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">142</span>    165   766</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">143</span>    126   760</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">144</span>    148   758</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">145</span>    138   754</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">146</span>     66   749</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">147</span>    355   748</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">148</span>    299   741</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">149</span>    392   741</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">150</span>     71   724</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">151</span>     30   707</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">152</span>    239   701</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">153</span>    185   692</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">154</span>    204   688</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">155</span>    174   652</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">156</span>      3   649</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">157</span>    180   646</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">158</span>    202   620</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">159</span>    390   620</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">160</span>    136   616</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">161</span>    121   612</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">162</span>    279   603</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">163</span>      1   596</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">164</span>     51   593</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">165</span>    305   575</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">166</span>    144   564</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">167</span>      9   533</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">168</span>    123   533</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">169</span>    124   533</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">170</span>      2   522</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">171</span>    119   510</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">172</span>    295   509</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">173</span>    280   506</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">174</span>    291   506</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">175</span>     11   495</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">176</span>    282   490</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">177</span>    194   484</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">178</span>    268   482</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">179</span>      5   481</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">180</span>     60   460</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">181</span>    301   459</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">182</span>     63   458</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">183</span>      7   454</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">184</span>    222   451</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">185</span>     20   446</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">186</span>    168   444</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">187</span>    288   441</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">188</span>    237   440</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">189</span>    354   438</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">190</span>     64   435</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">191</span>     93   435</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">192</span>    102   433</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">193</span>    125   425</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">194</span>     36   423</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">195</span>    114   420</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">196</span>    275   420</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">197</span>     58   417</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">198</span>    352   415</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">199</span>    374   412</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">200</span>    350   410</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">201</span>     62   407</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">202</span>    120   405</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">203</span>     70   403</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">204</span>    206   403</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">205</span>    294   402</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">206</span>    278   399</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">207</span>    210   395</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">208</span>    263   393</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">209</span>    292   390</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">210</span>     14   389</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">211</span>    105   380</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">212</span>     61   374</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">213</span>     10   364</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">214</span>    128   364</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">215</span>     89   362</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">216</span>    387   360</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">217</span>    342   359</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">218</span>    111   358</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">219</span>    129   358</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">220</span>     13   348</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">221</span>     34   348</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">222</span>     33   347</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">223</span>     38   344</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">224</span>    117   340</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">225</span>     91   337</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">226</span>     59   333</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">227</span>     16   332</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">228</span>    132   330</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">229</span>     65   323</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">230</span>    290   322</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">231</span>    218   314</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">232</span>     57   313</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">233</span>    389   313</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">234</span>     35   308</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">235</span>     37   307</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">236</span>     40   307</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">237</span>    281   306</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">238</span>     95   305</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">239</span>    296   302</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">240</span>     22   300</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">241</span>    108   299</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">242</span>     50   291</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">243</span>    388   291</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">244</span>     73   283</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">245</span>     68   281</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">246</span>    358   281</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">247</span>    207   279</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">248</span>    338   279</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">249</span>     46   275</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">250</span>     69   274</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">251</span>     90   268</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">252</span>    131   265</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">253</span>     67   262</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">254</span>     72   260</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">255</span>    130   260</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">256</span>    265   260</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">257</span>    135   259</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">258</span>     88   258</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">259</span>     94   257</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">260</span>    277   256</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">261</span>    115   253</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">262</span>    101   252</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">263</span>    357   250</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">264</span>    107   245</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">265</span>    262   245</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">266</span>    317   245</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">267</span>     96   243</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">268</span>     41   240</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">269</span>     45   238</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">270</span>    157   237</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">271</span>    293   237</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">272</span>    142   236</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">273</span>    349   230</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">274</span>    335   228</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">275</span>      4   224</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">276</span>    371   224</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">277</span>     29   223</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">278</span>    134   220</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">279</span>     39   218</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">280</span>    161   217</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">281</span>    375   217</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">282</span>    365   214</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">283</span>     43   213</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">284</span>    369   212</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">285</span>    315   211</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">286</span>    384   211</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">287</span>    104   210</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">288</span>    319   210</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">289</span>     49   206</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">290</span>    366   205</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">291</span>     87   203</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">292</span>     48   202</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">293</span>    346   202</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">294</span>    122   201</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">295</span>    351   201</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">296</span>    313   199</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">297</span>    343   198</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">298</span>    318   196</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">299</span>    285   195</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">300</span>    333   195</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">301</span>    364   194</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">302</span>    378   194</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">303</span>     15   193</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">304</span>    264   190</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">305</span>    373   190</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">306</span>    382   189</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">307</span>     55   187</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">308</span>    386   187</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">309</span>     74   185</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">310</span>    330   185</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">311</span>    109   184</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">312</span>     17   183</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">313</span>     53   177</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">314</span>    368   177</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">315</span>    287   176</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">316</span>     23   175</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">317</span>     56   175</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">318</span>    284   175</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">319</span>    289   175</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">320</span>    383   173</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">321</span>    380   172</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">322</span>    381   172</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">323</span>     19   169</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">324</span>    370   168</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">325</span>      6   167</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">326</span>    269   166</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">327</span>    345   163</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">328</span>    326   162</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">329</span>     18   160</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">330</span>    276   160</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">331</span>    116   159</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">332</span>    302   158</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">333</span>     99   157</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">334</span>    272   157</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">335</span>    103   155</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">336</span>    385   154</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">337</span>    372   153</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">338</span>    270   151</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">339</span>    379   150</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">340</span>     52   149</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">341</span>    182   149</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">342</span>    334   146</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">343</span>    376   146</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">344</span>     31   143</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">345</span>    377   143</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">346</span>    133   140</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">347</span>    361   138</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">348</span>    273   136</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">349</span>    325   135</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">350</span>    328   135</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">351</span>    127   134</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">352</span>    322   134</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">353</span>    336   134</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">354</span>     24   133</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">355</span>     47   132</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">356</span>    316   131</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">357</span>    327   131</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">358</span>     27   127</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">359</span>    340   127</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">360</span>    337   124</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">361</span>    320   122</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">362</span>    348   121</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">363</span>    331   120</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">364</span>    323   118</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">365</span>    362   116</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">366</span>    208   114</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">367</span>     32   113</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">368</span>     25   111</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">369</span>    339   111</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">370</span>    188   110</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">371</span>    367   110</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">372</span>    324   108</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">373</span>      8   106</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">374</span>    347   105</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">375</span>     44   104</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">376</span>    344   103</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">377</span>    360    99</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">378</span>    267    98</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">379</span>    341    97</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">380</span>    359    97</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">381</span>    160    95</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">382</span>     28    94</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">383</span>    159    93</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">384</span>    106    90</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">385</span>    118    90</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">386</span>    321    89</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">387</span>    329    86</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">388</span>    110    80</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">389</span>    100    71</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">390</span>    314    63</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">391</span>     97    52</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">392</span>    356    45</span></span></code></pre>
<p>We have 392 unique documents in the dataset. We also can see that the word lengths vary quite a bit. That's something we will need to keep in mind as we move forward into the analysis.</p>
<ol start="3" style="list-style-type: decimal">
<li>Check the values of the <code>pos</code> variable.</li>
</ol>
<p>The <code>pos</code> variable contains the part-of-speech tags for each word. The PENN Treebank tagset is used. Let's take a look at the values to get familiar with them, and also to see if there are any unexpected values.</p>
<p>Let's use the <code><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample()</a></code> function to randomly select a sample of the values. This will give us a sense of the values in the variable.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Preview pos</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 7</span></span></span>
<span><span class="co">##    doc_id term_num term          lemma         pos   modality genre</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>    303     <span style="text-decoration: underline;">2</span>511 proliferation proliferation NN    WR       TC   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     76     <span style="text-decoration: underline;">5</span>245 And           and           CC    WR       FT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    300    <span style="text-decoration: underline;">17</span>170 DAVY          davy          NNP   SP       MS   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>     80     <span style="text-decoration: underline;">5</span>341 ”             ”             NN    WR       FT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>    171      900 .             .             .     WR       TG   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>    166     <span style="text-decoration: underline;">2</span>588 out           out           RP    WR       BL   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>     67       58 organization  organization  NN    WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>    216     <span style="text-decoration: underline;">2</span>944 include       include       VB    WR       TG   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>    234     <span style="text-decoration: underline;">1</span>304 donation      donation      NN    WR       LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>    231     <span style="text-decoration: underline;">3</span>539 say           say           VB    WR       NF</span></span></code></pre>
<p>After running this code a few times, we can see that the many of the values are as expected. There are, however, some unexpected values. In particular, some punctuation and symbols are tagged as nouns.</p>
<p>We can get a better appreciation for the unexpected values by filtering the data to only show non alpha-numeric values (<code>^\\W+$</code>) in the <code>term</code> column and then tabulating the values by <code>term</code> and <code>pos</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter and tabulate</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">"^\\W+$"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">term</span>, <span class="va">pos</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">n</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 152 × 3</span></span></span>
<span><span class="co">##    term  pos       n</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">"</span>,<span style="color: #949494;">"</span>   ,     <span style="text-decoration: underline;">27</span>112</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">"</span>.<span style="color: #949494;">"</span>   .     <span style="text-decoration: underline;">26</span>256</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">"</span>\"<span style="color: #949494;">"</span>  ''     <span style="text-decoration: underline;">5</span>495</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">"</span>:<span style="color: #949494;">"</span>   :      <span style="text-decoration: underline;">4</span>938</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">"</span>?<span style="color: #949494;">"</span>   .      <span style="text-decoration: underline;">3</span>002</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">"</span>)<span style="color: #949494;">"</span>   )      <span style="text-decoration: underline;">2</span>447</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">"</span>(<span style="color: #949494;">"</span>   (      <span style="text-decoration: underline;">2</span>363</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">"</span>-<span style="color: #949494;">"</span>   :      <span style="text-decoration: underline;">1</span>778</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">"</span>!<span style="color: #949494;">"</span>   .      <span style="text-decoration: underline;">1</span>747</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">"</span>/<span style="color: #949494;">"</span>   NN     <span style="text-decoration: underline;">1</span>494</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> <span style="color: #949494;">"</span>’<span style="color: #949494;">"</span>   NN     <span style="text-decoration: underline;">1</span>319</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> <span style="color: #949494;">"</span>-<span style="color: #949494;">"</span>   -      <span style="text-decoration: underline;">1</span>213</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> <span style="color: #949494;">"</span>”<span style="color: #949494;">"</span>   NN     <span style="text-decoration: underline;">1</span>076</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span> <span style="color: #949494;">"</span>“<span style="color: #949494;">"</span>   NN     <span style="text-decoration: underline;">1</span>061</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span> <span style="color: #949494;">"</span>]<span style="color: #949494;">"</span>   NN     <span style="text-decoration: underline;">1</span>003</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span> <span style="color: #949494;">"</span>[<span style="color: #949494;">"</span>   NN     <span style="text-decoration: underline;">1</span>001</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span> <span style="color: #949494;">"</span>;<span style="color: #949494;">"</span>   :       991</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span> <span style="color: #949494;">"</span>--<span style="color: #949494;">"</span>  :       772</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">19</span> <span style="color: #949494;">"</span>&gt;<span style="color: #949494;">"</span>   NN      752</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">20</span> <span style="color: #949494;">"</span>...<span style="color: #949494;">"</span> ...     716</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 132 more rows</span></span></span></code></pre>
<p>As we can see from the sample above and from the PENN tagset documentation, most punctuation is tagged as the punctuation itself. For example, the period is tagged as <code>.</code> and the comma is tagged as <code>,</code>. Let's edit the data to reflect this.</p>
<p>Let's look at the code, and then we will discuss it.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recode</span></span>
<span><span class="va">masc_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pos <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">"^\\W+$"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html" class="external-link">str_sub</a></span><span class="op">(</span><span class="va">term</span>, start <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">pos</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">"^\\W+$"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># preview</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">term</span>, <span class="va">pos</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">n</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 127 × 3</span></span></span>
<span><span class="co">##    term  pos       n</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">"</span>,<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>,<span style="color: #949494;">"</span>   <span style="text-decoration: underline;">27</span>113</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">"</span>.<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>.<span style="color: #949494;">"</span>   <span style="text-decoration: underline;">26</span>257</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">"</span>\"<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span>\"<span style="color: #949494;">"</span>   <span style="text-decoration: underline;">5</span>502</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">"</span>:<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>:<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">4</span>939</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">"</span>?<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>?<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">3</span>002</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">"</span>-<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>-<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">2</span>994</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">"</span>)<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>)<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">2</span>447</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">"</span>(<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>(<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">2</span>363</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">"</span>!<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>!<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>747</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">"</span>/<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>/<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>495</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> <span style="color: #949494;">"</span>’<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>’<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>325</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> <span style="color: #949494;">"</span>”<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>”<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>092</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> <span style="color: #949494;">"</span>“<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>“<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>078</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span> <span style="color: #949494;">"</span>]<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>]<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>003</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span> <span style="color: #949494;">"</span>[<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>[<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>001</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span> <span style="color: #949494;">"</span>;<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>;<span style="color: #949494;">"</span>     993</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span> <span style="color: #949494;">"</span>--<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span>-<span style="color: #949494;">"</span>     772</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span> <span style="color: #949494;">"</span>&gt;<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>&gt;<span style="color: #949494;">"</span>     753</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">19</span> <span style="color: #949494;">"</span>...<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>.<span style="color: #949494;">"</span>     747</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">20</span> <span style="color: #949494;">"</span>'<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>'<span style="color: #949494;">"</span>     741</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 107 more rows</span></span></span></code></pre>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when()</a></code> function allows us to specify a series of conditions and values. The first condition is that the <code>term</code> variable contains only non alpha-numeric characters. If it does, then we want to replace the value of the <code>pos</code> variable with the first character of the <code>term</code> variable, <code>str_sub(term, start = 1, end = 1)</code>. If the condition is not met, then we want to keep the original value of the <code>pos</code> variable, <code>TRUE ~ pos</code>.</p>
<p>We can see that our code worked by filtering the data to only show non alpha-numeric values (<code>^\\W+$</code>) in the <code>term</code> column and then tabulating the values by <code>term</code> and <code>pos</code>.</p>
<p>For completeness, I will also recode the <code>lemma</code> values for these values as well as the lemma can some times be multiple punctuation marks (<em>e.g.</em> <code>!!!!!</code>, <code>---</code>, <em>etc.</em>) for these terms.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recode</span></span>
<span><span class="va">masc_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lemma <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">"^\\W+$"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html" class="external-link">str_sub</a></span><span class="op">(</span><span class="va">term</span>, start <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">lemma</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">"^\\W+$"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># preview</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">term</span>, <span class="va">lemma</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">n</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 127 × 3</span></span></span>
<span><span class="co">##    term  lemma     n</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">"</span>,<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>,<span style="color: #949494;">"</span>   <span style="text-decoration: underline;">27</span>113</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">"</span>.<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>.<span style="color: #949494;">"</span>   <span style="text-decoration: underline;">26</span>257</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">"</span>\"<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span>\"<span style="color: #949494;">"</span>   <span style="text-decoration: underline;">5</span>502</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">"</span>:<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>:<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">4</span>939</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">"</span>?<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>?<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">3</span>002</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">"</span>-<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>-<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">2</span>994</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">"</span>)<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>)<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">2</span>447</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">"</span>(<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>(<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">2</span>363</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">"</span>!<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>!<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>747</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">"</span>/<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>/<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>495</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> <span style="color: #949494;">"</span>’<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>’<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>325</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> <span style="color: #949494;">"</span>”<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>”<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>092</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> <span style="color: #949494;">"</span>“<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>“<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>078</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span> <span style="color: #949494;">"</span>]<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>]<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>003</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span> <span style="color: #949494;">"</span>[<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>[<span style="color: #949494;">"</span>    <span style="text-decoration: underline;">1</span>001</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span> <span style="color: #949494;">"</span>;<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>;<span style="color: #949494;">"</span>     993</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span> <span style="color: #949494;">"</span>--<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span>-<span style="color: #949494;">"</span>     772</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span> <span style="color: #949494;">"</span>&gt;<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>&gt;<span style="color: #949494;">"</span>     753</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">19</span> <span style="color: #949494;">"</span>...<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>.<span style="color: #949494;">"</span>     747</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">20</span> <span style="color: #949494;">"</span>'<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>'<span style="color: #949494;">"</span>     741</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 107 more rows</span></span></span></code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Check the values of the <code>modality</code> variable.</li>
</ol>
<p>The <code>modality</code> variable contains the modality tags for each document. Let's take a look at the values.</p>
<p>Let's tabulate the values with <code><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count()</a></code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tabulate modality</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">modality</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">##   modality      n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> SP       <span style="text-decoration: underline;">132</span>159</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> WR       <span style="text-decoration: underline;">458</span>938</span></span></code></pre>
<p>We see that the values are <code>SP</code> and <code>WR</code>, which stand for spoken and written, respectively. To make this a bit more transparent, we can recode these values to <code>Spoken</code> and <code>Written</code>. We will use the <code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when()</a></code> function to do this.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recode modality</span></span>
<span><span class="va">masc_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    modality <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">modality</span> <span class="op">==</span> <span class="st">"SP"</span> <span class="op">~</span> <span class="st">"Spoken"</span>,</span>
<span>      <span class="va">modality</span> <span class="op">==</span> <span class="st">"WR"</span> <span class="op">~</span> <span class="st">"Written"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">masc_df</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 591,097 × 7</span></span></span>
<span><span class="co">##    doc_id term_num term         lemma        pos   modality genre</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>      1        0 December     december     NNP   Written  LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>      1        1 1998         1998         CD    Written  LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>      1        2 Your         your         PRP$  Written  LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>      1        3 contribution contribution NN    Written  LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>      1        4 to           to           TO    Written  LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>      1        5 Goodwill     goodwill     NNP   Written  LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>      1        6 will         will         MD    Written  LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>      1        7 mean         mean         VB    Written  LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>      1        8 more         more         JJR   Written  LT   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>      1        9 than         than         IN    Written  LT   </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 591,087 more rows</span></span></span></code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Check the values of the <code>genre</code> variable.</li>
</ol>
<p>Let's look at the values of the <code>genre</code> variable.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tabulate genre</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">genre</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 18 × 2</span></span></span>
<span><span class="co">##    genre     n</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> BL    <span style="text-decoration: underline;">33</span>278</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> EM    <span style="text-decoration: underline;">62</span>036</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> ES    <span style="text-decoration: underline;">34</span>938</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> FC    <span style="text-decoration: underline;">38</span>608</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> FF    <span style="text-decoration: underline;">23</span>871</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> FT    <span style="text-decoration: underline;">34</span>373</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> GV    <span style="text-decoration: underline;">27</span>848</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> JK    <span style="text-decoration: underline;">32</span>420</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> JO    <span style="text-decoration: underline;">33</span>042</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> LT    <span style="text-decoration: underline;">26</span>468</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> MS    <span style="text-decoration: underline;">29</span>879</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> NF    <span style="text-decoration: underline;">29</span>531</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> NP    <span style="text-decoration: underline;">31</span>225</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span> TC    <span style="text-decoration: underline;">19</span>419</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span> TG    <span style="text-decoration: underline;">27</span>624</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span> TP     <span style="text-decoration: underline;">6</span>779</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span> TR    <span style="text-decoration: underline;">71</span>630</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span> TW    <span style="text-decoration: underline;">28</span>128</span></span></code></pre>
<p>These genre labels are definitely cryptic. The data dictionary does not list these labels and their more verbose descriptions. However, looking at the original data's README, we can find the file (<code>resource-headers.xml</code>) that lists these genre labels.</p>
<pre class="text"><code>1. 'BL' for blog
2. 'NP' is newspaper
3. 'EM' is email
4. 'ES' is essay
5. 'FT' is fictlets
6. 'FC' is fiction
7. 'GV' is government
8. 'JK' is jokes
9. 'JO' is journal
10. 'LT' is letters
11. 'MS' is movie script
12. 'NF' is non-fiction
13. 'FF' is face-to-face
14. 'TC' is technical
15. 'TG' is travel guide
16. 'TP' is telephone
17. 'TR' is transcript
18. 'TW' is twitter</code></pre>
<p>Now we can again use the <code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when()</a></code> function. This time we will see if <code>genre</code> is equal to one of the genre labels and if it is, then we will replace the value with the more verbose description.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recode genre</span></span>
<span><span class="va">masc_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    genre <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"BL"</span> <span class="op">~</span> <span class="st">"Blog"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"NP"</span> <span class="op">~</span> <span class="st">"Newspaper"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"EM"</span> <span class="op">~</span> <span class="st">"Email"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"ES"</span> <span class="op">~</span> <span class="st">"Essay"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"FT"</span> <span class="op">~</span> <span class="st">"Fictlets"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"FC"</span> <span class="op">~</span> <span class="st">"Fiction"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"GV"</span> <span class="op">~</span> <span class="st">"Government"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"JK"</span> <span class="op">~</span> <span class="st">"Jokes"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"JO"</span> <span class="op">~</span> <span class="st">"Journal"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"LT"</span> <span class="op">~</span> <span class="st">"Letters"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"MS"</span> <span class="op">~</span> <span class="st">"Movie script"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"NF"</span> <span class="op">~</span> <span class="st">"Non-fiction"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"FF"</span> <span class="op">~</span> <span class="st">"Face-to-face"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"TC"</span> <span class="op">~</span> <span class="st">"Technical"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"TG"</span> <span class="op">~</span> <span class="st">"Travel guide"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"TP"</span> <span class="op">~</span> <span class="st">"Telephone"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"TR"</span> <span class="op">~</span> <span class="st">"Transcript"</span>,</span>
<span>      <span class="va">genre</span> <span class="op">==</span> <span class="st">"TW"</span> <span class="op">~</span> <span class="st">"Twitter"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">masc_df</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 591,097 × 7</span></span></span>
<span><span class="co">##    doc_id term_num term         lemma        pos   modality genre  </span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>      1        0 December     december     NNP   Written  Letters</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>      1        1 1998         1998         CD    Written  Letters</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>      1        2 Your         your         PRP$  Written  Letters</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>      1        3 contribution contribution NN    Written  Letters</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>      1        4 to           to           TO    Written  Letters</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>      1        5 Goodwill     goodwill     NNP   Written  Letters</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>      1        6 will         will         MD    Written  Letters</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>      1        7 mean         mean         VB    Written  Letters</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>      1        8 more         more         JJR   Written  Letters</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>      1        9 than         than         IN    Written  Letters</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 591,087 more rows</span></span></span></code></pre>
<p>During the process of transformation and afterwards, it is a good idea to tabulate and/ or visualize the dataset. This provides us an opportunity to get to know the dataset better and also may help us identify inconsistencies that we would like to address in the transformation, or at least be aware of as we move towards analysis.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># How many documents are in each modality?</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">doc_id</span>, <span class="va">modality</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">modality</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">n</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">##   modality     n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Written    371</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Spoken      21</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># How many documents are in each genre?</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">doc_id</span>, <span class="va">genre</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">genre</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">n</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 18 × 2</span></span></span>
<span><span class="co">##    genre            n</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Email          174</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Newspaper       54</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Letters         49</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Blog            21</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Jokes           16</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Journal         12</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Essay            8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Fiction          7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Travel guide     7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Face-to-face     6</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 8 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># What is the averge length of documents (in words)?</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">doc_id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>    min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>    max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##    mean median   min   max</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> <span style="text-decoration: underline;">1</span>508.   418.    45 <span style="text-decoration: underline;">24</span>520</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">doc_id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="recipe-7_files/figure-html/masc-transformed-evaluation-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># What is the distribution of the length of documents by modality?</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">doc_id</span>, <span class="va">modality</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, fill <span class="op">=</span> <span class="va">modality</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="recipe-7_files/figure-html/masc-transformed-evaluation-2.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># What is the distribution of the length of documents by genre?</span></span>
<span><span class="va">masc_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">doc_id</span>, <span class="va">modality</span>, <span class="va">genre</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">genre</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">modality</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="recipe-7_files/figure-html/masc-transformed-evaluation-3.png" width="100%" style="display: block; margin: auto;"></p>
<p>Once we are satisfied with the structure and values of the dataset, we can save it to a file. We will use the <code><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv()</a></code> function from the <code>readr</code> package to do this.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save the data</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">masc_df</span>, <span class="st">"data/derived/masc/masc_transformed.csv"</span><span class="op">)</span></span></code></pre></div>
<p>The structure of the <code>data/</code> directory in our project should now look like this:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="ex">data/</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="ex">├──</span> analysis/</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a><span class="ex">├──</span> derived/</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a><span class="ex">│</span>   ├── masc_curated_dd.csv</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a><span class="ex">│</span>   ├── masc/</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a><span class="ex">│</span>   │   ├── masc_curated.csv</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a><span class="ex">│</span>   │   ├── masc_transformed.csv</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a><span class="ex">├──</span> original/</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="documenting-data">Documenting data<a class="anchor" aria-label="anchor" href="#documenting-data"></a>
</h3>
<p>The last step is to document the process and the resulting dataset(s). In this particular case we only derived one transformed dataset. The documentation steps are the same as in the curation step. We will organize and document the process file (often a <code>.qmd</code> file) and then create a data dictionary for each of the transformed datasets. The <code><a href="../reference/create_data_dictionary.html">create_data_dictionary()</a></code> function can come in handy for scaffolding the data dictionary file.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a data dictionary</span></span>
<span><span class="fu"><a href="../reference/create_data_dictionary.html">create_data_dictionary</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">masc_df</span>,</span>
<span>  file_path <span class="op">=</span> <span class="st">"data/derived/masc/masc_transformed_dd.csv"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>In this recipe, we have looked at an example of transforming a curated dataset. This recipe included operations such as:</p>
<ul>
<li>Text normalization</li>
<li>Variable recoding</li>
<li>Splitting variables</li>
</ul>
<p>In other projects, the transformation steps will inevitably differ, but these strategies are commonly necessary in almost any project.</p>
<p>Just as with other steps in the data preparation process, it is important to document the transformation steps. This will help you and others understand the process and the resulting dataset(s).</p>
</div>
<div class="section level2">
<h2 id="check-your-understanding">Check your understanding<a class="anchor" aria-label="anchor" href="#check-your-understanding"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Which function would you use to remove duplicate rows in a dataset? <select class="webex-select"><option value="blank"></option>
<option value="">group_by()</option>
<option value="">mutate()</option>
<option value="answer">distinct()</option>
<option value="">filter()</option></select>
</li>
<li>
<select class="webex-select"><option value="blank"></option>
<option value="">TRUE</option>
<option value="answer">FALSE</option></select> The <code><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c()</a></code> function from the <code>stringr</code> package is used to separate strings rather than combine them.</li>
<li>
<select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="">FALSE</option></select> The <code><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count()</a></code> function from the <code>dplyr</code> package is used to tabulate the values of a variable.</li>
<li>If you want to recode the age of learners into categories such as "child", "teen", and "adult" based on their age, which function should you use? <select class="webex-select"><option value="blank"></option>
<option value="">mutate()</option>
<option value="answer">case_when()</option>
<option value="">unite()</option>
<option value="">separate_wider_delim()</option></select>
</li>
<li>To normalize text by removing leading and trailing whitespace, you use the <input class="webex-solveme nospaces" size="8" data-answer='["str_trim"]'><code>()</code> function from the <code>stringr</code> package.</li>
<li>To normalize text by converting all characters to lowercase, you use the <input class="webex-solveme nospaces" size="12" data-answer='["str_to_lower"]'><code>()</code> function from the <code>stringr</code> package.</li>
</ol>
</div>
<div class="section level2">
<h2 id="lab-preparation">Lab preparation<a class="anchor" aria-label="anchor" href="#lab-preparation"></a>
</h2>
<!-- Lab 07 description and checklist -->
<p>In preparation for <a href="https://github.com/qtalr/lab-07" class="external-link">Lab 7</a>, review and ensure you are comfortable with the following:</p>
<ul>
<li>Vector, data frame, and list data structures</li>
<li>Subsetting and filtering data structures with and without regular expressions</li>
<li>Reshaping datasets by rows and columns</li>
</ul>
<p>In this lab, we will practice these skills and expand our knowledge of data preparation by transforming and documenting data with Tidyverse packages such as <code>dplyr</code>, <code>tidyr</code>, and <code>stringr</code>.</p>
<p>You will have a choice of a dataset to transform. Before you start the lab, you should consider which dataset you would like to use, what the idealized structure the transformed dataset will take, and what strategies you will likely employ to transform the dataset. You should also consider the information you need to document the data transformation process.</p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Ide2008" class="csl-entry">
Ide, Nancy, Collin Baker, Christiane Fellbaum, Charles Fillmore, and Rebecca Passonneau. 2008. <span>“MASC: The Manually Annotated Sub-Corpus of American English.”</span> In <em>6th International Conference on Language Resources and Evaluation, LREC 2008</em>, 2455–60. European Language Resources Association (ELRA).
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>

<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jerid Francom.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
